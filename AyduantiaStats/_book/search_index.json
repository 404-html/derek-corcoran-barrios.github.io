[
["index.html", "Practicos de Bioestadística 2 Requerimientos 0.1 Antes de comenzar 0.2 Descripción del práctico 0.3 Objetivos del práctico 0.4 Contenidos 0.5 Metodología 0.6 Evaluación 0.7 Libros de consulta", " Practicos de Bioestadística 2 Derek Corcoran 2019-03-08 Requerimientos Para comenzar el trabajo se necesita la última versión de R y RStudio (R Core Team 2018).También se requiere de los paquetes pacman, rmarkdown, tidyverse y tinytex. Si no se ha usado R o RStudio anteriormente, el siguiente video muestra cómo instalar ambos programas y los paquetes necesarios para este curso en el siguiente link. El código para la instalación de esos paquetes es el siguiente: install.packages(&quot;pacman&quot;, &quot;rmarkdown&quot;, &quot;tidyverse&quot;, &quot;tinytex&quot;) En caso de necesitar ayuda para la instalación, contactarse con el instructor del curso. 0.1 Antes de comenzar Si nunca se ha trabajado con R antes de este curso, una buena herramienta es provista por el paquete Swirl (Kross et al. 2017). Si deseas estar más preparado para el curso, realizá los primeros 7 modulos del programa R Programming: The basics of programming in R que incluye: Basic Building Blocks Workspace and Files Sequences of Numbers Vectors Missing Values Subsetting Vectors Matrices and Data Frames El siguiente link muestra un video explicativo de cómo usar el paquete swirl Video 0.2 Descripción del práctico Los prácticos de este curso se enfocan en aprender a realizar de manera práctica los conceptos enseñados en el cuso, pero además, usando herramientas interactivas y/o programáticas, el profundizar el entendimiento de ciertos conceptos teóricos y filosóficos del curso. 0.3 Objetivos del práctico Aprender el uso de R como ambiente estadístico de limpieza, exploración, visualización de datos. Conocer y aplicar de manera aplicada los conceptos enseñados en el curso de Bioestadistica 2. Aprender buenas prácticas de recolección y estandarización de bases de datos, con la finalidad de optimizar el análisis de datos y la revisión de éstas por pares. Realizar análisis críticos de la naturaleza de los datos al realizar análisis exploratorios, que permitirán determinar la mejor forma de comprobar hipótesis asociadas a estas bases de datos. 0.4 Contenidos Capítulo 1 Análisis exploratorio y el primer ANOVA: En este capítulo se aprenderá a cómo explorar, resumir y vizualizar una base de datos utilizando el paquete tidyverse (Wickham 2017), además se realizarán un análisis basico de ANOVA Capítulo 2 Supuestos de ANOVA y mínimos cuadrados Capítulo 3 Referencias 0.5 Metodología Clases prácticas donde cada estudiante trabajará con datos entregados para desarrollar análisi de datos. Además, se deberán generar informes, en base al trabajo con sus datos. 0.6 Evaluación Evaluación 1: Informe exploratorio de base de datos 25% Evaluación 2: Presentación 25% Evaluación 3: Informe final 50% 0.7 Libros de consulta Los principios de este curso están explicados en los siguientes libros gratuitos. Gandrud, Christopher. Reproducible Research with R and R Studio. CRC Press, 2013. Available for free in the following link Stodden, Victoria, Friedrich Leisch, and Roger D. Peng, eds. Implementing reproducible research. CRC Press, 2014. Available for free in the following link Referencias "],
["Explorando.html", "Práctico 1 Exploración de datos y tu primer ANOVA 1.1 Actividad 1 Educación en Chile 1.2 Actividad 2 Captación de CO2 en plantas 1.3 Actividad 3 Mi primer ANOVA", " Práctico 1 Exploración de datos y tu primer ANOVA 1.1 Actividad 1 Educación en Chile En esta actividad exploraremos los resultados de la PSU en Chile para el año 2017. Pueden encontrar la base de datos original en Data Chile. Trataremos de determinar, usando el puntaje de la PSU como medida, si existen brechas en la educación chilena por tipo de institución. Para ello, primero trabajaremos realizando análisis exploratorios en base a gráficos y tablas resumen usando funciones del paquete tidyverse (Wickham 2017) en R. La base de datos EducacionChile.csv se encuentra disponible en webcursos o en https://es.datachile.io/geo/chile#education. 1.1.1 Tablas resumen de los datos: Lo primero que deben hacer es generar una tabla resumen usando el tidyverse usando las funciones group_by para agrupar por variables y summarize para resumir los datos, dentro de summarize podemos usar variables como: mean() promedio sd() desviacion estándar n() número de muestras a modo de ejemplo vemos la tabla 1.1 mostrando la media y número de muestras con la base de datos iris: data(&quot;iris&quot;) Table &lt;- group_by(iris, Species) %&gt;% summarize(Promedio = mean(Petal.Length), N = n()) knitr::kable(Table) Tabla 1.1: Resumen con la media y número de muestras del largo de pétalo de las flores de tres especies del género Iris Species Promedio N setosa 1.462 50 versicolor 4.260 50 virginica 5.552 50 Basado en el resumen ¿Qué podemos decir de estos datos de educación en Chile? 1.1.2 Visualización de datos con ggplot2 (tidyverse) El paquete ggplot2 (Wickham 2016) es una poderosa herramienta para gráficar datos. Si desean ahondar en el uso de este paquete, pueden ver el siguiente link http://zevross.com/blog/2014/08/04/beautiful-plotting-in-r-a-ggplot2-cheatsheet-3/. En este caso, aprenderemos a graficar boxplots y jitterplots, dos opciones para visualizar una variable categórica versus una cuantitativa. 1.1.2.1 Uso del ggplot2 Su función principal es ggplot, luego de cada función usaremos el símbolo + como usabamos el pipeline (%&gt;%). Primero usamos la función ggplot para determinar la base de datos y variables, acá las variables siempre van dentro de la función aes ggplot(MiBaseDeDatos, aes(x = VariableX, y = VariableY)) Luego agregamos el tipo de gráfico que queremos para nuestra figura usando el + como pipeline ggplot(MiBaseDeDatos, aes(x = VariableX, y = VariableY)) + geom_boxplot() 1.1.2.2 Ejemplo usando la base de datos iris 1.1.2.2.1 Boxplot El siguiente código muestra como graficar un boxplot para la base de datos iris, la cual esta en R. En este caso graficaremos el largo del pétalo para cada especie (Figura 1.1). data(&quot;iris&quot;) ggplot(iris, aes(x = Species, y = Petal.Length)) + geom_boxplot() Figura 1.1: Box plot del largo de petalo de tres especies del género Iris En los Box Plots tenemos 4 visualizaciones: Mediana (linea grueza) Caja (Cuantiles 25% y 75%) Bigotes (intervalo de confianza del 95%) Puntos Outlayers Realice un boxplot de los datos de la educación de Chile, ¿Qué nos dice esto de los datos? 1.1.2.2.2 Jitter plot El jitter plot suma un punto por cada observación, lo cual nos permite entender un poco más la naturaleza de los datos. En general se le agrega a un box plot para tener mayor claridad en los datos (Figura 1.2). data(&quot;iris&quot;) ggplot(iris, aes(x = Species, y = Petal.Length)) + geom_boxplot() + geom_jitter(aes(color = Species)) Figura 1.2: Box plot y jitter plot juntos para el largo de petalo de tres especies del género Iris 1.2 Actividad 2 Captación de CO2 en plantas Utilizaremos base de datos \\(CO_2\\) (Potvin, Lechowicz, and Tardif 1990) enviada al curso. Esta base de datos, tambien presente en R, tiene las siguientes variables Plant: Identidad de cada planta Type: Variedad de la planta (subespecie Quebec o Mississippi) Treatment: Tratamiento de la planta, algunas fueron enfriadas la noche anterior (Chilled) conc: Concentración ambiental de \\(CO_2\\) Uptake: Captación de \\(CO_2\\) para cada planta en cada día ¿Hay diferencias entre la captación de \\(CO_2\\) en plantas tratadas y no tratadas? Genere tablas resumenes que le permitan explorar esta pregunta ¿Existen variables que puedan confundir el resultado? ¿como trataría los datos para lidiar con esto? Genere gráficos exploratorios para contestar esta pregunta 1.3 Actividad 3 Mi primer ANOVA En R todos los modelos tienen la siguiente estructura Funcion(y ~ x1 + x2 + … + xn, data = MisDatos), donde la Funcion dice el modelo que queremos realizar (por ejemplo ANOVA, regresión lineal, modelos mixtos, etc.), y es la variable que queremos explicar, x1 a xn son las variables explicativas, ~ es un simbolo que debe ser leído como explicado por y finalmente data es la base de datos que queremos utlizar, en un ANOVA (análisis de varianza), la función en cuestion es aov. En el siguiente código vemos si el largo del pétalo de las flores del género Iris, pueden ser explicados por la especie a la que estas plantas pertenecen, por lo que generamos un modelo llamado Primer.Anova con la función aov. Primer.Anova &lt;- aov(Petal.Length ~ Species, data = iris) Para acceder a la tabla de resultados utilizamos la función summary ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## Species 2 437.1 218.55 1180 &lt;2e-16 *** ## Residuals 147 27.2 0.19 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Si establecemos el valor de alfa en 0.05 y al ver en la tabla que el valor de p es menor a alfa, rechazamos la hipótesis nula de que las medias son iguales, y decidimos que la media del largo de pétalo es distinta entre las especies. 1.3.1 Ejercicio Determine si para la base de datos CO2 la captación de \\(CO_2\\) es distinto entre platnas con tratamiento de enfriamiento y sin enfriamiento. Referencias "],
["Supuestos.html", "Práctico 2 Supuestos de ANOVA y mínimos cuadrados 2.1 Objetivos de este práctico 2.2 Actividad 1 Sueño en mamíferos 2.3 Actividad 2 Suma de cuadrados 2.4 Referencias", " Práctico 2 Supuestos de ANOVA y mínimos cuadrados 2.1 Objetivos de este práctico Entender los supuestos de un ANOVA de una via (independencia, aleatoreidad, homocedasticidad y normalidad) Entender el concepto de mínimos cuadrados Saber cuando realizar un ANOVA e interpretar sus resultados 2.2 Actividad 1 Sueño en mamíferos En esta actividad intentaremos ver si hay diferencias en horas de sueño en mamíferos por Orden o dieta. Los datos fueron extraidos del trabajo de Savage and West (2007) y estan incorporados en la base de datos de ggplot2 con el nombre de msleep, pero estarán en webcursos en formato csv de todas formas. Para la guía los ejemplos se generarán en base a la base de datos InsectSprays que está en R y que fue extraída de Beall (1942), en la cual se testean la efectividad de insecticidas en Spray en la abundancia de insectos en plantaciones. Y en la base de datos iris que ya fue entregada, en la que se miden distintas caracteristicas florales de especies del genero Iris (Anderson 1935). 2.2.1 Homogeneidad de varianza 2.2.1.1 Inspección visual Lo primero que intentaremos explorar de forma visual y a partir de tests si es que hay homogeneidad de varianza, para esto usaremos boxplots, y jitter plots (Figura 2.1), lo cual ya hemos hecho anteriormente: ggplot(InsectSprays, aes(x = spray, y = count)) + geom_boxplot() + geom_jitter(aes(color = spray)) Figura 2.1: Cuenta de insectos según tipo de insecticida Para explorar visualmente si existe homogeneidad de varianza, se compraran las cajas y bigotes de los boxplots y se espera que tengan (Mas o menos distintos tamaños). 2.2.1.2 Test de Bartlett Para realizar un test de homogeneidad de varianza se realiza el test de bartlett (Bartlett 1937), en este se usa nuestra conocida formula y ~ x, esto es, y explicado por x junto a la función bartlett.test. Para nuestro caso usariamos: ## ## Bartlett test of homogeneity of variances ## ## data: count by spray ## Bartlett&#39;s K-squared = 25.96, df = 5, p-value = 9.085e-05 Como en este caso, no el valor de p es menor a 0.05, decimos que no hay homogeneidad de varianza, por lo que no podemos hacer el test. 2.2.2 Normalidad de los residuales En el caso de la base de datos iris, demostraremos inmediatamente que si hay homogeneidad de varianza en el ancho del sépalo (Figura 2.2): Figura 2.2: Ancho de sépalo según especie del género Iris ## ## Bartlett test of homogeneity of variances ## ## data: Sepal.Width by Species ## Bartlett&#39;s K-squared = 2.0911, df = 2, p-value = 0.3515 Debido a ello, podemos testar si los residuales tienen una distribución normalidad de los residuales, para esto lo primero que debemos hacer es un ANOVA, como fue explicado en el práctico anterior y guardar este objeto con un nombre: 2.2.2.1 Extracción de los residuales del modelo Para exter los residuales, podemos hacerlo de dos formas, si solo queremos un vector de sus valores, podemos extraelo desde el modelo mimso utlizando $residuals. Si queremos guardarlo en un dataframe mas completo podemos utilizar la función augment del paquete broom. La segunda opción nos entregará más información que podremos utilizar más tarde, pero ambas sirven para testear normalidad, la siguiente tabla muestra las primeras 6 observaciones generadas por la función augment, donde resid, son los residuales (Ver tabla 2.1. Tabla 2.1: primeras 6 observaciones del dataframe resultante de augment Sepal.Width Species .fitted .se.fit .resid .hat .sigma .cooksd .std.resid 3.5 setosa 3.428 0.048 0.072 0.02 0.341 0.000 0.214 3.0 setosa 3.428 0.048 -0.428 0.02 0.339 0.011 -1.273 3.2 setosa 3.428 0.048 -0.228 0.02 0.340 0.003 -0.678 3.1 setosa 3.428 0.048 -0.328 0.02 0.340 0.006 -0.975 3.6 setosa 3.428 0.048 0.172 0.02 0.341 0.002 0.511 3.9 setosa 3.428 0.048 0.472 0.02 0.339 0.013 1.404 2.2.2.2 Inspección visual de los residuales Existen dos formas de visualizar los residuales para determinar si la distribución de estos es o no es normal, histogramas y el qqplot. 2.2.2.2.1 Histograma Los histogramas nos darán una representación visual para tratar de entender si la distribución es normal, para esto, solo necesitamos usar el comando hist, seguido del vector de los residuales, este es el comando para hacer el histograma (Figura 2.3) con cualquiera de las dos bases de datos, el resultado debiera ser el mismo: hist(Residuales) hist(Resultados$.resid) Figura 2.3: Histograma de los resiudales del modelo ANOVA 2.2.2.2.2 QQplot El qq plot es otra forma visual de establecer si los residuales son o no son normales, para esto, lo esperado es que la gráfica resultante sea una diagonal lo mas recta posible, para esto usaremos la función qqnorm, con nuestros residuales, denuevo, podemos usar cualquiera de las dos versiones de nuestros datos: qqnorm(Residuales) qqnorm(Resultados$.resid) Figura 2.4: qqplot de los resiudales del modelo ANOVA 2.2.2.3 Test de Shapiro para determinar normalidad La forma más sencilla de determinar normalidad es usando el test de Shapiro-Wilk de normalidad (Royston 1995). Al igual que el test de Bartlett, si el valor de p es menor a 0.05, determinamos que la distribución de los datos no son normales, la función en R para este test es shapiro.test, y al igual que en los casos anteriores de hist y qqpot, solo necesitamos de usar un vector de residuales para ver el resultado del test. En nuestro caso: shapiro.test(Residuales) shapiro.test(Resultados$.resid) ## ## Shapiro-Wilk normality test ## ## data: Residuales ## W = 0.98948, p-value = 0.323 Ya que el valor de p es menor a 0.05, podemos decir que la distribución de nuestros residuales es normal, y por lo tanto el test cumple con los supuestos, y esto hace que sea valido el ANOVA, por lo que podemos ver nuestros resultados. La homogeneidad de Varianza es mas importante que la normalidad de residuales para estos casos, para ejemplos de lo que se debe hacer si se viola la normalidad ver Lix, Keselman, and Keselman (1996) 2.3 Actividad 2 Suma de cuadrados Tanto los ANOVAS como las regresiones lineales se basan en minimizar la suma de cuadrados, es la suma de los cuadrados de los errores o residuales. 2.3.1 ¿Que es el error? ¿Por qué al cuadrado?? Figura 2.5: Errores de una regresión lineal ejemplificados con la linea entre el valor predicho y el observado En la figura y en la formula vemos ejemplificado que es el error, también conocido como residual, este es simplemente el valor observado \\[Observado - Predicho\\] El objetivo de todo modelo es el de minimizar estos errores, al ajustar el mejor modelo posible. Los errores seimpre se calculan al cuadrado, discutiremos por que en clase \\[\\sum_{i=1}^{n} (Observado - Predicho)^2\\] 2.4 Referencias Referencias "],
["Refs.html", "Práctico 3 Referencias", " Práctico 3 Referencias "]
]
